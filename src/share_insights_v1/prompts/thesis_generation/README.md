# Thesis Generation Prompt Templates\n\nThe thesis generator now uses external prompt templates instead of hardcoded prompts, making it easy to experiment with different prompt variations.\n\n## ğŸ“ File Structure\n\n```\nsrc/share_insights_v1/prompts/thesis_generation/\nâ”œâ”€â”€ base_thesis_prompt.txt      # Base template with all variables\nâ”œâ”€â”€ bull_case_prompt.txt        # Bull case specific template\nâ”œâ”€â”€ bear_case_prompt.txt        # Bear case specific template\nâ””â”€â”€ objective_case_prompt.txt   # Objective/balanced template\n```\n\n## ğŸ”§ Usage\n\n### Loading Prompts\n\n```python\nfrom src.share_insights_v1.utils.prompt_loader import ThesisPromptLoader\n\n# Initialize loader\nloader = ThesisPromptLoader()\n\n# Load a specific prompt template\nbull_prompt = loader.load_prompt('bull_case')\n\n# Format with data\nformatted_prompt = loader.format_prompt('bull_case', \n    ticker='AAPL',\n    target_price=185.50,\n    current_price_str='$175.25',\n    # ... other variables\n)\n```\n\n### Available Prompt Types\n\n- `bull_case` - Bullish investment thesis focused on growth opportunities\n- `bear_case` - Bearish investment thesis focused on risks and challenges  \n- `objective` - Balanced investment thesis with objective analysis\n- `base` - Base template with all variables (for reference)\n\n## ğŸ“ Template Variables\n\nPrompts use Python string formatting with these variables:\n\n### Core Variables\n- `{ticker}` - Stock ticker symbol\n- `{company_type}` - Company classification (e.g., \"Large Cap Technology\")\n- `{target_price}` - Algorithmic target price (float)\n- `{current_price_str}` - Current market price as formatted string\n\n### Financial Metrics\n- `{market_cap}` - Market capitalization\n- `{pe_ratio}` - Price-to-earnings ratio\n- `{revenue_growth}` - Revenue growth rate\n- `{gross_margin}` - Gross profit margin\n- `{roe}` - Return on equity\n- `{debt_to_equity}` - Debt-to-equity ratio\n\n### Analysis Data\n- `{strengths}` - Comma-separated list of company strengths\n- `{risks}` - Comma-separated list of risk factors\n- `{industry_outlook}` - Industry outlook assessment\n- `{news_count}` - Number of news articles analyzed\n- `{sentiment_rating}` - News sentiment rating\n\n### Validation Data\n- `{average_target}` - Cross-method average target price\n- `{consensus_strength}` - Valuation consensus strength\n- `{dcf_calculation_details}` - DCF calculation breakdown\n- `{startup_calculation_details}` - Startup valuation details\n\n## ğŸ›ï¸ Prompt Management Interface\n\nAccess the prompt management interface through the dashboard:\n\n1. Navigate to the Prompt Management page\n2. Select a prompt template to edit\n3. Make changes in the text editor\n4. Preview with sample data\n5. Save changes\n\n### Features\n- **Live Editing**: Edit prompts directly in the browser\n- **Preview**: See how prompts look with sample data\n- **Backup**: Automatic backup before saving changes\n- **Reset**: Restore to default templates\n- **Variables Reference**: Built-in list of available variables\n\n## ğŸ§ª Testing Prompts\n\nRun the test script to verify prompt loading and formatting:\n\n```bash\npython test_prompts.py\n```\n\nThis will:\n- Test loading all prompt templates\n- Test formatting with sample data\n- Verify file information retrieval\n- Test handling of missing variables\n\n## ğŸ”„ Integration with Thesis Generator\n\nThe thesis generation code automatically uses the appropriate prompt template based on the selected thesis type:\n\n```python\n# In thesis_generation_full.py\nfrom src.share_insights_v1.utils.prompt_loader import ThesisPromptLoader\n\n# Initialize prompt loader\nprompt_loader = ThesisPromptLoader()\n\n# Map thesis types to prompt types\nprompt_type_map = {\n    \"Bull Case\": \"bull_case\",\n    \"Bear Case\": \"bear_case\", \n    \"Objective\": \"objective\"\n}\n\n# Load and format the appropriate prompt\nprompt_type = prompt_type_map.get(thesis_type, \"objective\")\nprompt = prompt_loader.format_prompt(prompt_type, **prompt_data)\n```\n\n## ğŸ“‹ Best Practices\n\n### Editing Prompts\n1. **Test Changes**: Always preview prompts before saving\n2. **Use Variables**: Leverage template variables for dynamic content\n3. **Maintain Structure**: Keep the established section structure\n4. **Document Changes**: Note significant modifications\n\n### Variable Handling\n1. **Safe Defaults**: The system provides safe defaults for missing variables\n2. **Type Safety**: Ensure numeric variables are properly formatted\n3. **Error Handling**: Missing critical variables will raise clear errors\n\n### Performance\n1. **Caching**: Prompts are cached after first load\n2. **Clear Cache**: Cache is cleared when templates are saved\n3. **File Size**: Keep prompts reasonable in size for performance\n\n## ğŸš€ Benefits\n\n1. **Flexibility**: Easy to experiment with different prompt variations\n2. **Maintainability**: Prompts are separate from code logic\n3. **Collaboration**: Non-technical users can edit prompts\n4. **Version Control**: Prompt changes are tracked in git\n5. **Testing**: Easy to test different prompt approaches\n6. **Backup**: Automatic backup system prevents data loss\n\n## ğŸ”® Future Enhancements\n\n- **Prompt Versioning**: Track prompt template versions\n- **A/B Testing**: Compare different prompt variations\n- **Performance Metrics**: Measure prompt effectiveness\n- **Template Library**: Share successful prompt templates\n- **Dynamic Sections**: Conditional prompt sections based on data\n- **Multi-language**: Support for different language prompts